
@{
    ViewBag.Title = "landingPage";
}
<h2>Landing page</h2>

<a href="/Account/MyAccount">My Account</a>


        <div id="chatViewModel">

            @*<ul data-bind="foreach:onlineUsers">
                <li data-bind="text:id"></li>
                <li data-bind="click:$parent.sendTo,text:name"></li>
            </ul>*@

                <div class="small-chat-box fadeInRight animated">

                    <div class="heading" draggable="true">
                        <small class="chat-date pull-right">
                            02.19.2015
                        </small>
                        Small chat
                    </div>

                    <div class="content" data-bind="foreach:showChat">

                        @*<div class="left">
                        <div class="author-name">
                            Monica Jackson <small class="chat-date">
                                10:02 am
                            </small>
                        </div>
                        <div class="chat-message active">
                            Lorem Ipsum is simply dummy text input.
                        </div>

                    </div>
                    <div class="right">
                        <div class="author-name">
                            Mick Smith
                            <small class="chat-date">
                                11:24 am
                            </small>
                        </div>
                        <div class="chat-message">
                            Lorem Ipsum is simpl.
                        </div>
                    </div>
                    <div class="left">
                        <div class="author-name">
                            Alice Novak
                            <small class="chat-date">
                                08:45 pm
                            </small>
                        </div>
                        <div class="chat-message active">
                            Check this stock char.
                        </div>
                    </div>
                    <div class="right">
                        <div class="author-name">
                            Anna Lamson
                            <small class="chat-date">
                                11:24 am
                            </small>
                        </div>
                        <div class="chat-message">
                            The standard chunk of Lorem Ipsum
                        </div>
                    </div>*@

                        <div class="left">
                            <div class="author-name">
                                <div data-bind="text:sentToName"></div>                                <small data-bind="text:timeAgo" class="chat-date">

                                </small>
                            </div>
                            <div class="chat-message active" data-bind="text:message">
                            </div>
                        </div>


                    </div>
                    <div class="form-chat">
                        <div class="input-group input-group-sm">
                            <input type="text" data-bind="value:newMessage,valueUpdate:'afterkeydown',event:{keyup:checkMsgEnter}" class="form-control"> <span class="input-group-btn">
                                <button class="btn btn-primary" data-bind="click:sendMessage" type="button">
                                    Send
                                </button>
                            </span>
                        </div>
                    </div>

                </div>
                <div id="small-chat">

                    <span class="badge badge-warning pull-right">5</span>
                    <a class="open-small-chat">
                        <i class="fa fa-comments"></i>

                    </a>
                </div>
</div>
        @section Styles{
            @Styles.Render("~/plugins/toastrStyles")
        }
        @section Scripts{
            @Scripts.Render("~/plugins/toastr")
            @Scripts.Render("~/plugins/timeago")
            @Scripts.Render("~/plugins/autosize")
            @Scripts.Render("~/plugins/knockout")

<script src="~/Scripts/jquery.signalR-2.2.0.js"></script>
<script src="~/signalr/hubs"></script>
<script src="~/Scripts/app/chat.js"></script>
            <script>
                function getTimeAgo(varDate) {
                    if (varDate) {
                        return $.timeago(varDate.toString().slice(-1) == 'Z' ? varDate : varDate + 'Z');
                    }
                    else {
                        return '';
                    }
                }
                $(function () {
                    var model = new ChatViewModel();
                   // ko.applyBindings(new AccountViewModel(), document.getElementById("AccountViewModel"));
                   // ko.applyBindings(model, document.getElementById("chatViewModel"));
                    ko.applyBindings(model);
                    //var conn = $.connection.chatHub;
                    $.connection.hub.start().done(function () {
                        //model.init();
                    });
                        //.done(function () {
                        //model.init();
                    //})
                });
            </script>
        }
